---
phase: 01-core-video-processing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - requirements.txt
  - .env.example
  - bot/__init__.py
  - bot/config.py
  - bot/main.py
autonomous: true

must_haves:
  truths:
    - "Bot se inicia correctamente con token de Telegram"
    - "Estructura de proyecto está organizada"
    - "Dependencias están declaradas en requirements.txt"
  artifacts:
    - path: "requirements.txt"
      provides: "Lista de dependencias del proyecto"
      min_lines: 5
      contains: "python-telegram-bot"
    - path: "bot/main.py"
      provides: "Punto de entrada del bot"
      min_lines: 20
      exports: ["main"]
    - path: "bot/config.py"
      provides: "Configuración centralizada"
      min_lines: 10
  key_links:
    - from: "bot/main.py"
      to: "bot/config.py"
      via: "import"
---

<objective>
Configurar la estructura base del bot de Telegram con python-telegram-bot v20+.

Purpose: Establecer la base técnica sobre la cual se construirá el procesamiento de videos.
Output: Proyecto Python funcional con bot que responde a mensajes de video.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Crear estructura de proyecto y dependencias</name>
  <files>requirements.txt, .env.example, bot/__init__.py</files>
  <action>
Crear la estructura base del proyecto:

1. Crear `requirements.txt` con:
   - python-telegram-bot>=20.0
   - python-dotenv>=1.0.0

2. Crear `.env.example` con:
   - BOT_TOKEN=your_telegram_bot_token_here

3. Crear directorio `bot/` con `__init__.py` vacío

4. Crear `bot/config.py` que:
   - Cargue variables de entorno con python-dotenv
   - Valide que BOT_TOKEN exista (raise ValueError si falta)
   - Exponga BOT_TOKEN como constante

IMPORTANTE: No hardcodear el token, usar variables de entorno.
  </action>
  <verify>
python -c "from bot.config import BOT_TOKEN; print('Config OK')"
  </verify>
  <done>Archivo requirements.txt creado, config.py carga BOT_TOKEN desde env</done>
</task>

<task type="auto">
  <name>Task 2: Implementar bot básico con handler de videos</name>
  <files>bot/main.py</files>
  <action>
Crear `bot/main.py` con:

1. Importar Application, CommandHandler, MessageHandler, filters desde telegram.ext
2. Importar BOT_TOKEN desde bot.config
3. Crear función start(update, context) que responda "Envíame un video y lo convertiré en nota de video"
4. Crear función handle_video(update, context) que:
   - Reciba el mensaje con video
   - Responda temporalmente "Video recibido, procesando..."
   - (El procesamiento real viene en Plan 02)
5. Configurar Application con:
   - CommandHandler("start", start)
   - MessageHandler(filters.VIDEO, handle_video)
6. Función main() que inicie el bot con polling

IMPORTANTE: Usar python-telegram-bot v20+ (async/await). Toda la API es async.
  </action>
  <verify>
python -c "from bot.main import main; print('Main imports OK')"
  </verify>
  <done>Bot responde a /start y detecta videos enviados por el usuario</done>
</task>

<task type="auto">
  <name>Task 3: Agregar script de entrada y verificar sintaxis</name>
  <files>run.py</files>
  <action>
Crear `run.py` en la raíz del proyecto:

1. Importar asyncio
2. Importar main desde bot.main
3. Ejecutar main() con asyncio.run()
4. Manejar KeyboardInterrupt gracefulmente

Verificar que todo el código tenga sintaxis válida:
- python -m py_compile bot/*.py
- python -m py_compile run.py

No ejecutar el bot todavía (no hay token configurado), solo verificar imports.
  </action>
  <verify>
python -m py_compile bot/config.py bot/main.py run.py && echo "Syntax OK"
  </verify>
  <done>run.py existe, sintaxis válida en todos los archivos</done>
</task>

</tasks>

<verification>
- [ ] requirements.txt tiene python-telegram-bot>=20.0
- [ ] bot/config.py carga BOT_TOKEN desde variables de entorno
- [ ] bot/main.py tiene handlers para /start y videos
- [ ] run.py puede importarse sin errores
- [ ] Todos los archivos tienen sintaxis Python válida
</verification>

<success_criteria>
1. Estructura de proyecto creada (bot/ como paquete Python)
2. Dependencias declaradas en requirements.txt
3. Configuración centralizada en bot/config.py
4. Bot básico implementado con handlers
5. Script de entrada run.py funcional
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-video-processing/01-01-SUMMARY.md`
</output>
